## 9. Анализ потоков данных. Связь MOP-, MFP-, ideal-решений. Абстрактная интерпретация. Понятие решётки. Понятия конкретного и абстрактного состояний.  Связь абстрактной интерпретации и анализа потока данных.

### Абстрактная интерпретация

**Абстрактная интерпретация** – теория корректной аппроксимации семантики
программы.

Задача абстрактной интерпретации – построить корректные абстракции для анализа
программы.

Важно: одни и те же абстракции можно применять при проведении различных
анализов.

**Конкретные состояния программы** – значение всех переменных программы в
определённый момент времени.

*∑* – совокупность всех конкретных состояний

Возможные траектории, запретные зоны, абстрактные траектории.
[вставь картинку]

Абстрактное состояние – подмножество множества всех конкретных состояний
программы.

*L* – совокупность абстрактных состояний

*L ⊆ 2^∑*

### Решетки с верхним и нижним элементами

Множество *L* с двумя бинарными операциями *∧* (сбор) и *∨* (объединение) называется
решёткой, если верно, что:

1. *a ∨ a = a, a ∧ a = a* (идемпотентность)

2. *a ∨ b = b ∨ a, a ∧ b = b ∧ a* (коммутативность)

3. *a ∨ a ∧ b = a ∧ a ∨ b* (поглощение)

4. *a ∨ b ∨ c = a ∨ b ∨ c , a ∧ b ∧ c = a ∧ b ∧ c* (ассоциативность)

*a ≤ b* ⇔ *a ∨ b = b* или *a ∧ b = a*

*∃ ⊤,⊥ ∈ L : ∀ a ∈ L, ⊥ ≤ a ≤ ⊤*

*2^∑* – решётка:
*∧* – пересечение, *∨* – объединение, *⊥* – *∅* , *⊤* – *∑*

### Требования к множество абстрактных состояний

Множество абстрактных состояний должно являться решёткой с верхним и нижним
элементом.

Важно: операции сбора и объединения могут не совпадать с пересечением и
объединением соответствующих множеств конкретных состояний.

* Задано соответствие между *L* и *2^Σ* , а именно:  
  конкретизация: *φ(l) = σ, где l ∈ L, σ ∈ 2^Σ*  
  абстракция: *ψ(σ) = l, где l ∈ L, σ ∈ 2^Σ*

* *φ(l)* задаётся по построению

* *ψ(σ)* определяется как самое точное *l*, такое что: *σ ∈  φ(l)*

* *φ(l)* и *ψ(σ)* задают соответствие Галуа: σ ≤ φ(ψ(σ))

### Передаточные функции

Передаточной функцией для инструкции *I* будем называть отображение *Tᵢ ∶ L →
L*, задающее семантику инструкции *I* для абстрактных состояний.

Построим точную передаточную функцию при помощи функций соответствия.

Пусть *Tᵢ^Σ ∶ 2^Σ → 2^Σ* , передаточная функция заданная для *2^Σ* в соответствии с
семантикой *I*, тогда: *Tᵢ(l) = ψ(Tᵢ^Σ(φ(l)))*

### Свойства построенной передаточной функции

* Данная передаточная функция является самой точной для данного множества
  абстрактных состояний.

* Используемые на практике передаточные функции могут быть менее точными, чем
  Tᵢ.

* Пусть *Tᵢ′* произвольная функция из *L → L*, тогда для того, чтобы её можно
  было бы использовать в качестве передаточной функции, необходимо чтобы: *Tᵢ(l)
⊆ Tᵢ′(l)*

Использование менее точных передаточных функций называется *widening*. Оно
применяется для ускорения сходимости анализа потока данных.

### Применение абстрактной интерпретации

* Вычисление необходимых условий для каждой точки программы

    - Поиск недостижимого кода

    - Поиск константных выражений

* Символьное выполнение программы

    - Поиск переполнения буфера

    - Поиск разыменования нулевого указателя

### Вычисление необходимых условий

* Заметим, что *2^Σ* и *Tᵢ^Σ* могут быть использованы при анализе потока данных

* Тогда MOP-решение для заданного базового блока *B* даст набор всех возможных
  конкретных состояний, с которыми программа может оказаться в данном базовом
блоке. Обозначим его *Pᴮ, Pᴮ ∈ 2^Σ*.

* Тогда необходимым условием для *B* будем называть такое абстрактное состояние
  *l*, что *Pᴮ ⊆ φ(l)*.
