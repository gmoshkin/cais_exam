## 4. Понятие ошибки и уязвимости в ПО. Жизненный цикл уязвимости. Понятие и структура эксплоита. Классификация ошибок в ПО. Классификатор CWE. Оценка критичности ошибки по CVSS.

**Уязвимость информационной системы** — свойство информационной системы,
обусловливающее возможность реализации угроз безопасности обрабатываемой в ней
информации.

### Жизненный цикл уязвимости

**Окно уязвимости** — время от возникновения уязвимости до исправления
соответствующей ошибки или обеспечения невозможности атаки.

**Уязвимость нулевого дня (zero-day)** — уязвимость, для которой на данный момент
нет исправления или способа защиты.

```
│
├─ Обнаружение ────────────┐                         │
│                          │                         │
├─ Эксплоит                │ Риски до раскрытия      │ Информация не публична
│                          │                         │
├─ Раскрытие ──────────────┼─────────────────────────┼────────────────────────
│                          │ Риски после раскрытия   │
├─ Исправление ────────────┼─────────────────────────┤ Информация публична
│                          │ Риски после исправления │
├─ Применение исправления ─┘                         │
│
```

**Эксплоит** — программа, фрагмент кода или последовательность команд, использующие
уязвимость, чтобы добиться непредусмотренного поведения информационной системы.

В идеале атакующий пытается перехватить поток управления уязвимой системы, чтобы
выполнить произвольный код:
* **полезная нагрузка** — внедряемый код;
* **шелл-код** — полезная нагрузка, дающая доступ к интерпретатору команд ОС.

### Ошибки в программах

* **Ошибки в логике приложения**

* **Ошибки уровня архитектуры приложения** (неверная работа с разделяемыми ресурсами
  в многопоточном ПО)

* **Несоответствие требованиям со стороны аппаратуры** (неверная адресация в памяти,
  целочисленное деление на 0)

* **Несоответствие модели языка программирования** (выход за границы массива,
  нарушение правил алиасинга, ABI)


### Ошибки и закладки

**Разработчик** → Исходный код → **Компилятор** → Бинарный код → **Системное
окружение**

### Нарушения безопасности в ПО

1. Нарушение **конфиденциальности**:

    - OpenSSL Heartbleed;

    - программная закладка в роутере;

    - шпионаж через веб-камеру в телевизоре.

2. Нарушение **целостности**:

    - программная закладка в роутере;

    - изменение базы данных с паролями через внедрение SQL-кода.

3. Нарушение **доступности**:

    - аварийное завершение, зависание программы;

    - отказ в обслуживании — DoS, DDoS.

### Последствия ошибок

1. Перехват потока управления:

    - возможность нарушения всех трёх аспектов безопасности информации;

    - может быть осуществлено скрытно.

2. Ошибки времени выполнения:

    - нарушение доступности, а в некоторых случаях и целостности;

    - потенциально при редком стечении обстоятельств возможно также и нарушение
      конфиденциальности;

    - как правило, достаточно быстро обнаруживаются;

    - сравнительно легче поддаются автоматическому выявлению.

3. Безопасность информационных потоков.

===

### Классификация ошибок

1. Классификация по ГОСТ Р 56546—2015:

    - порядка 20 типов недостатков, приводящих к уязвимостям, простое
      перечисление.

2. MITRE Common Weakness Enumeration (CWE):

    - обширная база знаний, систематизация типов ошибок и взаимосвязей между
      ними.

3. HP Enterprise Security Fortify Taxonomy:

    - древовидная организация;

    - группировка по языкам и «царствам».

4. Банк данных угроз безопасности информации ФСТЭК:

    - плоский список, порядка 200 типов угроз;

    - источники, объект воздействия, последствия.

### MITRE CWE

* Иерархическая модель — от общего к частному.

* Этап внесения ошибки (проектирование, реализация...).

* Языки программирования.

* Возможные угрозы конфиденциальности, целостности, доступности.

* Связи между разными типами ошибок — «предшествует», «следует за», «также
  является».

* Примеры: фрагменты кода и конкретные уязвимости в распространённом ПО.

* Предотвращение и противодействие.

===

### Оценка критичности ошибки

**Common Vulnerability Scoring System** (CVSS) — способ численного выражения
степени критичности ошибки.

#### Группы метрик:

* сложность реализации уязвимости;

    1. AV — вектор атаки:
        - N — атака по сети;
        - A — атака по локальной сети;
        - L — атака в рамках одной машины;
        - P — атака с физическим доступом.
    2. AC — сложность воспроизведения:
        - L — низкая;
        - H — высокая.
    3. PR — требуемые полномочия:
        - N — отсутствуют;
        - L — низкие;
        - H — высокие.
    4. UI — взаимодействие с пользователем:
        - N — не требуется;
        - R — требуется.

* степень нарушения конфиденциальности, целостности и доступности;

    1. C — степень нарушения конфиденциальности информации:
        - H — высокая;
        - L — низкая;
        - N — нарушения конфиденциальности нет.
    2. I — степень нарушения целостности информации:
        - H — высокая;
        - L — низкая;
        - N — нарушения целостности нет.
    3. A — степень нарушения доступности информации:
        - H — высокая;
        - L — низкая;
        - N — нарушения доступности нет.

* взаимосвязь между уязвимым компонентом системы и тем, безопасность которого
  нарушается.
